# Usar la imagen SDK de .NET Core para compilar la aplicaci칩n
# Use the SDK image for building
FROM mcr.microsoft.com/dotnet/sdk:7.0 AS build-env
WORKDIR /api/webapicontrolcitas
EXPOSE 4200
EXPOSE 4201

# Copy the entire content of the BackEnd directory
COPY WebApiControlCitas /api


# Restore NuGet packages
RUN dotnet restore

RUN ls -la /api

# Build and publish the application
RUN dotnet publish -c Release -o out

# Use the ASP.NET Core runtime image for the final image
FROM mcr.microsoft.com/dotnet/sdk:7.0 AS runtime
WORKDIR /api

# Copy the published output from the build image
COPY --from=build-env /api/webapicontrolcitas/out .

# Exponer el puerto en el que la aplicaci칩n escuchar치

# Definir el comando de ejecuci칩n
ENTRYPOINT ["dotnet", "WebApiControlCitas.dll"]